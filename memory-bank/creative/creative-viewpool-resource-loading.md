# ViewPool èµ„æºåŠ è½½æµç¨‹è®¾è®¡

## ğŸ¨ğŸ¨ğŸ¨ ENTERING CREATIVE PHASE: Architecture Design

### 1. éœ€æ±‚åˆ†æ

#### 1.1 æ ¸å¿ƒéœ€æ±‚
- **é¢„åŠ è½½æœºåˆ¶**ï¼šåœ¨éœ€è¦ä¹‹å‰æå‰åŠ è½½ Prefabï¼Œé¿å…è¿è¡Œæ—¶å¡é¡¿
- **åŒæ­¥æ¥å£**ï¼š`ViewPool.get()` æ˜¯åŒæ­¥æ–¹æ³•ï¼Œä¸è§¦å‘åŠ è½½
- **èŒè´£åˆ†ç¦»**ï¼šViewPool åªè´Ÿè´£æ± åŒ–ï¼ŒResourceManager è´Ÿè´£åŠ è½½
- **æ¶æ„çº¦æŸ**ï¼šViewPool ä¸æ¥æ”¶ entityIdï¼Œä¸ç®¡ç†åŠ è½½çŠ¶æ€ï¼Œä¸è¿”å›ä¸´æ—¶ Node

#### 1.2 çº¦æŸæ¡ä»¶
- **æ¶æ„çº¦æŸï¼ˆâš ï¸ çº¢çº¿ï¼‰**ï¼š
  - ViewPool ä¸æ¥æ”¶ entityIdï¼ˆPresentation å±‚ä¸åº”çŸ¥é“ ECSï¼‰
  - ViewPool.get() æ˜¯åŒæ­¥æ–¹æ³•ï¼Œä¸è§¦å‘åŠ è½½ï¼Œä¸è¿”å›ä¸´æ—¶ Node
  - ViewPool ä¸ç®¡ç†åŠ è½½çŠ¶æ€ï¼ˆç”± ResourceManager ç®¡ç†ï¼‰
  - ViewPool ä¸æä¾› getAsync()ï¼ˆé¿å…ç ´åå”¯ä¸€å‡ºå£è§„åˆ™ï¼‰
  - æ‰€æœ‰å¼‚æ­¥åŠ è½½åªå‘ç”Ÿåœ¨ preload é˜¶æ®µ
- **èŒè´£è¾¹ç•Œ**ï¼š
  - ResourceManagerï¼šåŠ è½½ã€ç¼“å­˜ã€çŠ¶æ€ç®¡ç†ã€è·¯å¾„æ˜ å°„
  - ViewPoolï¼šæ± åŒ–ã€å®ä¾‹åŒ–ã€å¤ç”¨
- **æ€§èƒ½çº¦æŸ**ï¼š
  - é¢„åŠ è½½åº”åœ¨å¯åŠ¨æ—¶æˆ–åœºæ™¯åˆ‡æ¢æ—¶è¿›è¡Œ
  - æ‰¹é‡é¢„åŠ è½½ä½¿ç”¨å¹¶è¡ŒåŠ è½½
- **èµ„æºé‡Šæ”¾**ï¼š
  - å…ˆæ¸…ç©º ViewPoolï¼Œå†æ¸…ç©º ResourceManager
  - ä¸å•ç‹¬é‡Šæ”¾ Prefabï¼ˆé¿å… Node ä»åœ¨ä½¿ç”¨æ—¶é‡Šæ”¾ï¼‰

### 2. è®¾è®¡é€‰é¡¹

#### é€‰é¡¹ 1ï¼šçº¯é¢„åŠ è½½æ¨¡å¼ï¼ˆæ¨èï¼‰
**æè¿°**ï¼š
- æ‰€æœ‰ Prefab å¿…é¡»åœ¨ `get()` è°ƒç”¨å‰é€šè¿‡ `preloadPrefab()` é¢„åŠ è½½
- `get()` æ—¶å¦‚æœ Prefab æœªåŠ è½½ï¼Œè¿”å› null
- èµ„æºè·¯å¾„åœ¨ preload æ—¶ä¼ å…¥ï¼Œä¸å­˜å‚¨

**ä¼˜ç‚¹**ï¼š
- âœ… å®ç°ç®€å•ï¼Œé€»è¾‘æ¸…æ™°
- âœ… é¿å…è¿è¡Œæ—¶åŠ è½½å¯¼è‡´çš„å¡é¡¿
- âœ… èŒè´£è¾¹ç•Œæ¸…æ™°
- âœ… ç¬¦åˆæ¶æ„çº¦æŸ

**ç¼ºç‚¹**ï¼š
- éœ€è¦æå‰çŸ¥é“æ‰€æœ‰éœ€è¦çš„ Prefab
- æœªé¢„åŠ è½½æ—¶è¿”å› nullï¼Œéœ€è¦ RenderSyncSystem å¤„ç†

#### é€‰é¡¹ 2ï¼šæŒ‰éœ€åŠ è½½ + é¢„åŠ è½½æ··åˆæ¨¡å¼ï¼ˆâŒ å·²åºŸå¼ƒï¼‰
**æè¿°**ï¼š
- æ”¯æŒé¢„åŠ è½½ï¼ˆæ¨èï¼‰
- æ”¯æŒæŒ‰éœ€åŠ è½½ï¼ˆfallbackï¼‰
- `get()` æ—¶å¦‚æœ Prefab æœªåŠ è½½ï¼Œè§¦å‘å¼‚æ­¥åŠ è½½ï¼Œè¿”å›ä¸´æ—¶ Node
- åŠ è½½å®Œæˆåé€šè¿‡äº‹ä»¶é€šçŸ¥ï¼Œæ›´æ–°ä¸´æ—¶ Node

**é—®é¢˜**ï¼š
- âŒ ä¸´æ—¶ Node æ›¿æ¢ä¼šå¯¼è‡´äº‹ä»¶ä¸¢å¤±ã€å¼•ç”¨å¤±æ•ˆã€UI é—ªçƒ
- âŒ ç ´åæ¶æ„è¾¹ç•Œï¼ˆViewPool ä¸åº”ç®¡ç†åŠ è½½çŠ¶æ€ï¼‰
- âŒ å®ç°å¤æ‚ï¼Œé£é™©é«˜

#### é€‰é¡¹ 3ï¼šé…ç½®é©±åŠ¨çš„é¢„åŠ è½½ + åŒæ­¥ç­‰å¾…ï¼ˆâŒ å·²åºŸå¼ƒï¼‰
**æè¿°**ï¼š
- ä½¿ç”¨é…ç½®æ–‡ä»¶å®šä¹‰ `prefabKey -> path` æ˜ å°„
- å¯åŠ¨æ—¶æ‰¹é‡é¢„åŠ è½½æ‰€æœ‰é…ç½®çš„ Prefab
- `get()` æ—¶å¦‚æœ Prefab æœªåŠ è½½ï¼ŒåŒæ­¥ç­‰å¾…åŠ è½½å®Œæˆï¼ˆé˜»å¡ï¼‰

**é—®é¢˜**ï¼š
- âŒ åŒæ­¥ç­‰å¾…å¯èƒ½é˜»å¡ä¸»çº¿ç¨‹
- âŒ éœ€è¦é¢„çŸ¥æ‰€æœ‰èµ„æº

#### é€‰é¡¹ 4ï¼šçº¯é¢„åŠ è½½ + èŒè´£åˆ†ç¦»ï¼ˆæ¨èï¼‰
**æè¿°**ï¼š
- åªæ”¯æŒé¢„åŠ è½½ï¼ˆå¯åŠ¨æ—¶/åœºæ™¯åˆ‡æ¢æ—¶ï¼‰
- `get()` æ—¶å¦‚æœ Prefab æœªåŠ è½½ï¼Œè¿”å› nullï¼ˆä¸è¿”å›ä¸´æ—¶ Nodeï¼‰
- åŠ è½½çŠ¶æ€ç”± ResourceManager ç®¡ç†
- èµ„æºè·¯å¾„åœ¨ preload æ—¶ä¼ å…¥ï¼Œä¸å­˜å‚¨

**ä¼˜ç‚¹**ï¼š
- âœ… èŒè´£æ¸…æ™°ï¼ˆViewPool åªè´Ÿè´£æ± åŒ–ï¼‰
- âœ… æ¶æ„ç®€å•ï¼Œæ— çŠ¶æ€ç®¡ç†è´Ÿæ‹…
- âœ… ä¸è¿”å›ä¸´æ—¶ Nodeï¼Œé¿å…äº‹ä»¶ä¸¢å¤±
- âœ… ç¬¦åˆå”¯ä¸€å‡ºå£è§„åˆ™

**ç¼ºç‚¹**ï¼š
- éœ€è¦æå‰é¢„åŠ è½½æ‰€æœ‰éœ€è¦çš„ Prefab
- æœªé¢„åŠ è½½æ—¶è¿”å› nullï¼Œéœ€è¦ RenderSyncSystem å¤„ç†

### 3. æ¨èæ–¹æ¡ˆï¼šé€‰é¡¹ 4ï¼ˆçº¯é¢„åŠ è½½ + èŒè´£åˆ†ç¦»ï¼‰

#### 3.1 è®¾è®¡ç†ç”±
1. **æ¶æ„æ¸…æ™°**ï¼šèŒè´£è¾¹ç•Œæ˜ç¡®ï¼ŒViewPool åªè´Ÿè´£æ± åŒ–
2. **å®‰å…¨æ€§**ï¼šä¸è¿”å›ä¸´æ—¶ Nodeï¼Œé¿å…äº‹ä»¶ä¸¢å¤±ã€å¼•ç”¨å¤±æ•ˆ
3. **ç¬¦åˆçº¦æŸ**ï¼šä¸æ¥æ”¶ entityIdï¼Œä¸æä¾› getAsync()ï¼Œä¸ç®¡ç†åŠ è½½çŠ¶æ€
4. **ç®€å•å¯é **ï¼šå®ç°ç®€å•ï¼Œé£é™©ä½ï¼Œæ˜“äºç»´æŠ¤

#### 3.2 æ ¸å¿ƒè®¾è®¡

##### 3.2.1 èµ„æºè·¯å¾„ç®¡ç†
- **ä¸å­˜å‚¨è·¯å¾„**ï¼šViewPool ä¸ç»´æŠ¤è·¯å¾„æ˜ å°„
- **è·¯å¾„æ¥æº**ï¼šåªåœ¨ `preloadPrefab(prefabKey, path)` æ—¶ä¼ å…¥
- **è·¯å¾„ç®¡ç†**ï¼šç”±è°ƒç”¨è€…ï¼ˆå¦‚ ResourcePreloaderï¼‰ç®¡ç†è·¯å¾„é…ç½®

##### 3.2.2 åŠ è½½çŠ¶æ€ç®¡ç†
- **ä¸ç®¡ç†çŠ¶æ€**ï¼šViewPool ä¸ç®¡ç†åŠ è½½çŠ¶æ€
- **çŠ¶æ€æŸ¥è¯¢**ï¼šç”± ResourceManager æä¾›åŠ è½½çŠ¶æ€æŸ¥è¯¢
- **å¯ç”¨æ€§æ£€æŸ¥**ï¼šViewPool åªæä¾› `hasPrefab(prefabKey)` æ£€æŸ¥ Prefab æ˜¯å¦å·²è®¾ç½®åˆ° NodePool

##### 3.2.3 ViewPool æ¥å£æ‰©å±•
```typescript
class ViewPool {
    // é¢„åŠ è½½å•ä¸ª Prefabï¼ˆé€šè¿‡ ResourceManagerï¼‰
    async preloadPrefab(prefabKey: string, path: string): Promise<void>;
    
    // æ‰¹é‡é¢„åŠ è½½
    async preloadPrefabs(paths: { prefabKey: string; path: string }[]): Promise<void>;
    
    // æ£€æŸ¥ Prefab æ˜¯å¦å¯ç”¨ï¼ˆå·²åŠ è½½åˆ° NodePoolï¼‰
    hasPrefab(prefabKey: string): boolean;
    
    // è·å–è§†å›¾ï¼ˆåŒæ­¥ï¼Œå¦‚æœ Prefab æœªåŠ è½½è¿”å› nullï¼‰
    // âš ï¸ æ¶æ„çº¦æŸï¼šä¸æ¥æ”¶ entityIdï¼ŒViewPool ä¸åº”çŸ¥é“ ECS å®ä½“
    // ownerKey ä»…ç”¨äºè°ƒè¯•/æ—¥å¿—ï¼Œä¸å‚ä¸é€»è¾‘
    get(prefabKey: string, ownerKey?: string): Node | null;
}
```

**âš ï¸ å…³é”®æ¶æ„çº¦æŸ**ï¼š
1. **ä¸æ¥æ”¶ entityId**ï¼šViewPool æ˜¯ Presentation å±‚ï¼Œä¸åº”çŸ¥é“ ECS çš„ entityId
2. **ä¸æä¾› getAsync()**ï¼šå¼‚æ­¥åŠ è½½åªå‘ç”Ÿåœ¨ ResourceManager å’Œ preload é˜¶æ®µ
3. **ä¸ç®¡ç† LoadStatus**ï¼šåŠ è½½çŠ¶æ€ç”± ResourceManager ç®¡ç†
4. **ä¸è¿”å›ä¸´æ—¶ Node**ï¼šæœªåŠ è½½æ—¶è¿”å› nullï¼Œç”± RenderSyncSystem å†æ¬¡è§¦å‘ SpawnView

##### 3.2.4 åŠ è½½æµç¨‹

**é¢„åŠ è½½æµç¨‹ï¼ˆå”¯ä¸€æ¨èçš„åŠ è½½æ–¹å¼ï¼‰**ï¼š
```
1. è°ƒç”¨ preloadPrefab(prefabKey, path)
2. è°ƒç”¨ ResourceManager.loadPrefab(path)ï¼ˆResourceManager å¤„ç†ç¼“å­˜å’Œå»é‡ï¼‰
3. è·å– Prefab åï¼Œè®¾ç½®åˆ° NodePool.setPrefab(prefab)
4. å®Œæˆ
```

**get() æµç¨‹ï¼ˆåŒæ­¥ï¼Œä¸è§¦å‘åŠ è½½ï¼‰**ï¼š
```
1. è°ƒç”¨ get(prefabKey, ownerKey?)
2. æŸ¥æ‰¾å¯¹åº”çš„ NodePool
3. æ£€æŸ¥ NodePool æ˜¯å¦æœ‰ Prefab
   - æœ‰ Prefab â†’ ä»æ± ä¸­è·å–æˆ– instantiate æ–° Node
   - æ—  Prefab â†’ è¿”å› nullï¼ˆâš ï¸ ä¸è¿”å›ä¸´æ—¶ Nodeï¼‰
4. è¿”å› Node æˆ– null
```

**âš ï¸ å…³é”®çº¦æŸ**ï¼š
- `get()` ä¸è§¦å‘åŠ è½½ï¼Œä¸è¿”å›ä¸´æ—¶ Node
- æœªåŠ è½½æ—¶è¿”å› nullï¼Œç”± RenderSyncSystem å†æ¬¡è§¦å‘ SpawnView
- æ‰€æœ‰å¼‚æ­¥åŠ è½½åªå‘ç”Ÿåœ¨ preload é˜¶æ®µ

#### 3.3 å®ç°ç»†èŠ‚

##### 3.3.1 èŒè´£è¾¹ç•Œï¼ˆâš ï¸ æ¶æ„çº¢çº¿ï¼‰

**ResourceManager è´Ÿè´£**ï¼š
- Prefab çš„åŠ è½½ã€ç¼“å­˜ã€é‡Šæ”¾
- åŠ è½½çŠ¶æ€ç®¡ç†ï¼ˆLoadingã€Loadedã€Failedï¼‰
- Promise åˆå¹¶ï¼ˆé¿å…é‡å¤åŠ è½½ï¼‰
- è·¯å¾„åˆ° Asset çš„æ˜ å°„

**ViewPool è´Ÿè´£**ï¼š
- Prefab åˆ° Node çš„å®ä¾‹åŒ–
- Node çš„æ± åŒ–ç®¡ç†å’Œå¤ç”¨
- æ£€æŸ¥ Prefab æ˜¯å¦å¯ç”¨ï¼ˆhasPrefabï¼‰

**ViewPool ä¸è´Ÿè´£**ï¼š
- âŒ åŠ è½½çŠ¶æ€ç®¡ç†ï¼ˆLoadStatusï¼‰
- âŒ Promise ç®¡ç†
- âŒ è·¯å¾„é…ç½®
- âŒ é”™è¯¯å¤„ç†ï¼ˆåŠ è½½å¤±è´¥ï¼‰
- âŒ entityId ç»‘å®š

##### 3.3.2 èµ„æºè·¯å¾„ç®¡ç†
- **è·¯å¾„æ¥æº**ï¼šåªåœ¨ `preloadPrefab(prefabKey, path)` æ—¶ä¼ å…¥
- **ä¸å­˜å‚¨è·¯å¾„**ï¼šViewPool ä¸ç»´æŠ¤è·¯å¾„æ˜ å°„ï¼Œè·¯å¾„åªåœ¨ preload æ—¶ä½¿ç”¨
- **è·¯å¾„ç®¡ç†**ï¼šç”±è°ƒç”¨è€…ï¼ˆå¦‚ ResourcePreloaderï¼‰ç®¡ç†è·¯å¾„é…ç½®

##### 3.3.3 é”™è¯¯å¤„ç†
- **åŠ è½½å¤±è´¥**ï¼šç”± ResourceManager å¤„ç†ï¼ŒViewPool ä¸å…³å¿ƒ
- **get() æ—¶æ—  Prefab**ï¼šè¿”å› nullï¼Œä¸åˆ›å»ºä¸´æ—¶ Node
- **é™çº§ç­–ç•¥**ï¼šç”± ViewManager å¤„ç†ï¼ŒViewPool åªè´Ÿè´£æ± åŒ–

##### 3.3.4 èµ„æºé‡Šæ”¾è§„åˆ™ï¼ˆâš ï¸ é‡è¦ï¼‰

**é‡Šæ”¾é¡ºåº**ï¼š
1. å…ˆæ¸…ç©º ViewPoolï¼ˆé”€æ¯æ‰€æœ‰ Nodeï¼‰
2. å†æ¸…ç©º ResourceManagerï¼ˆé‡Šæ”¾ Prefabï¼‰

**é‡Šæ”¾æ—¶æœº**ï¼š
- åœºæ™¯åˆ‡æ¢æ—¶
- æ¸¸æˆç»“æŸæ—¶
- ä¸å•ç‹¬é‡Šæ”¾ Prefabï¼ˆé¿å… Node ä»åœ¨ä½¿ç”¨æ—¶é‡Šæ”¾ï¼‰

**åŸå› **ï¼š
- Prefab è¢« NodePool é—´æ¥ä½¿ç”¨ï¼ˆé€šè¿‡ instantiateï¼‰
- é‡Šæ”¾ Prefab ä½† Node ä»åœ¨æ± ä¸­ = æœªå®šä¹‰è¡Œä¸º
- MVP é˜¶æ®µæœ€ç¨³è§„åˆ™ï¼šä¸å•ç‹¬é‡Šæ”¾ Prefab

##### 3.3.5 å‘åå…¼å®¹
- å¦‚æœæ²¡æœ‰ ResourceManagerï¼Œ`get()` è¿”å› nullï¼ˆä¸å†åˆ›å»ºç®€å• Nodeï¼‰
- ä¿æŒç°æœ‰ `preloadPrefab()` æ¥å£ä¸å˜

### 4. ä½¿ç”¨åœºæ™¯

#### åœºæ™¯ 1ï¼šå¯åŠ¨æ—¶é¢„åŠ è½½ï¼ˆå”¯ä¸€æ¨èæ–¹å¼ï¼‰
```typescript
// åœ¨ GameApp.onLoad() ä¸­
await viewPool.preloadPrefab('player', 'prefabs/player');
await viewPool.preloadPrefab('enemy', 'prefabs/enemy');

// è¿è¡Œæ—¶ä½¿ç”¨ï¼ˆRenderSyncSystem ä¸­ï¼‰
const node = viewPool.get('player'); // ç«‹å³è¿”å›ï¼Œæ— å»¶è¿Ÿ
if (node) {
    // ä½¿ç”¨ node
} else {
    // Prefab æœªåŠ è½½ï¼Œç­‰å¾…ä¸‹æ¬¡ RenderSyncSystem è§¦å‘
}
```

#### åœºæ™¯ 2ï¼šæ‰¹é‡é¢„åŠ è½½
```typescript
// ä½¿ç”¨ ResourcePreloader æ‰¹é‡é¢„åŠ è½½
await viewPool.preloadPrefabs([
    { prefabKey: 'player', path: 'prefabs/player' },
    { prefabKey: 'enemy', path: 'prefabs/enemy' }
]);
```

#### åœºæ™¯ 3ï¼šåœºæ™¯åˆ‡æ¢æ—¶é¢„åŠ è½½
```typescript
// åœºæ™¯åˆ‡æ¢å‰
await viewPool.preloadPrefab('boss', 'prefabs/boss');

// åœºæ™¯ä¸­ä½¿ç”¨ï¼ˆRenderSyncSystem ä¸­ï¼‰
const bossNode = viewPool.get('boss');
```

#### âš ï¸ ç¦æ­¢çš„ä½¿ç”¨æ–¹å¼

```typescript
// âŒ é”™è¯¯ï¼šåœ¨ ECS ç³»ç»Ÿä¸­ await ViewPool
const node = await viewPool.getAsync('player'); // ç ´åå”¯ä¸€å‡ºå£è§„åˆ™

// âŒ é”™è¯¯ï¼šä¼ é€’ entityId
const node = viewPool.get('player', entityId); // ViewPool ä¸åº”çŸ¥é“ entityId

// âŒ é”™è¯¯ï¼šæœŸæœ›è¿”å›ä¸´æ—¶ Node
const node = viewPool.get('player');
if (!node) {
    // ä¸åº”è¯¥åœ¨è¿™é‡Œè§¦å‘åŠ è½½
    await viewPool.preloadPrefab('player');
}
```

**æ­£ç¡®æµç¨‹**ï¼š
1. é¢„åŠ è½½é˜¶æ®µï¼šä½¿ç”¨ `preloadPrefab()` æˆ– `preloadPrefabs()`
2. è¿è¡Œæ—¶ï¼š`get()` è¿”å› Node æˆ– null
3. å¦‚æœè¿”å› nullï¼šç”± RenderSyncSystem åœ¨ä¸‹ä¸€å¸§å†æ¬¡è§¦å‘ SpawnView

### 5. å®ç°æ­¥éª¤

1. **ä¿®æ­£ get() æ–¹æ³•ç­¾å**
   - åˆ é™¤ `entityId` å‚æ•°
   - æ·»åŠ å¯é€‰çš„ `ownerKey` å‚æ•°ï¼ˆä»…ç”¨äºæ—¥å¿—ï¼‰
   - `get(prefabKey: string, ownerKey?: string): Node | null`

2. **ç®€åŒ– preloadPrefab æ–¹æ³•**
   - åªæ¥æ”¶ `prefabKey` å’Œ `path`
   - è°ƒç”¨ `ResourceManager.loadPrefab(path)`
   - è·å– Prefab åè®¾ç½®åˆ° NodePool
   - ä¸ç®¡ç†åŠ è½½çŠ¶æ€ï¼ˆç”± ResourceManager ç®¡ç†ï¼‰

3. **å®ç°æ‰¹é‡é¢„åŠ è½½**
   - `preloadPrefabs(paths: { prefabKey: string; path: string }[]): Promise<void>`
   - ä½¿ç”¨ `Promise.all()` å¹¶è¡ŒåŠ è½½

4. **å®ç° hasPrefab æ–¹æ³•**
   - `hasPrefab(prefabKey: string): boolean`
   - æ£€æŸ¥ NodePool æ˜¯å¦æœ‰ Prefab

5. **æ”¹è¿› get æ–¹æ³•**
   - æ£€æŸ¥ NodePool æ˜¯å¦æœ‰ Prefab
   - æœ‰ Prefab â†’ ä»æ± ä¸­è·å–æˆ– instantiate
   - æ—  Prefab â†’ è¿”å› nullï¼ˆâš ï¸ ä¸åˆ›å»ºä¸´æ—¶ Nodeï¼‰

6. **åˆ é™¤ä¸éœ€è¦çš„åŠŸèƒ½**
   - âŒ åˆ é™¤ `getAsync()` æ–¹æ³•
   - âŒ åˆ é™¤ `setPrefabPaths()` æ–¹æ³•
   - âŒ åˆ é™¤ `getLoadStatus()` æ–¹æ³•
   - âŒ åˆ é™¤åŠ è½½çŠ¶æ€ç®¡ç†ï¼ˆLoadStatusã€PrefabLoadInfoï¼‰

7. **æ·»åŠ èµ„æºé‡Šæ”¾è§„åˆ™**
   - åœ¨ `clear()` æ–¹æ³•ä¸­å…ˆæ¸…ç©ºæ‰€æœ‰ Node
   - æ–‡æ¡£è¯´æ˜ï¼šPrefab é‡Šæ”¾ç”± ResourceManager ç»Ÿä¸€ç®¡ç†

8. **æ·»åŠ å•å…ƒæµ‹è¯•**
   - æµ‹è¯• preloadPrefab
   - æµ‹è¯• get() è¿”å› null çš„æƒ…å†µ
   - æµ‹è¯•æ‰¹é‡é¢„åŠ è½½
   - æµ‹è¯•èµ„æºé‡Šæ”¾é¡ºåº

### 6. æ³¨æ„äº‹é¡¹

1. **æ€§èƒ½è€ƒè™‘**ï¼š
   - é¢„åŠ è½½åº”åœ¨å¯åŠ¨æ—¶æˆ–åœºæ™¯åˆ‡æ¢æ—¶è¿›è¡Œï¼Œé¿å…è¿è¡Œæ—¶å¡é¡¿
   - æ‰¹é‡é¢„åŠ è½½ä½¿ç”¨ `Promise.all()` å¹¶è¡ŒåŠ è½½
   - `get()` æ˜¯åŒæ­¥çš„ï¼Œä¸è§¦å‘åŠ è½½ï¼Œä¿è¯æ€§èƒ½

2. **å†…å­˜ç®¡ç†**ï¼š
   - Prefab ç”± ResourceManager ç¼“å­˜ï¼ŒViewPool ä¸é‡å¤ç¼“å­˜
   - **é‡Šæ”¾é¡ºåº**ï¼šå…ˆæ¸…ç©º ViewPoolï¼Œå†æ¸…ç©º ResourceManager
   - **ä¸å•ç‹¬é‡Šæ”¾ Prefab**ï¼šé¿å… Node ä»åœ¨ä½¿ç”¨æ—¶é‡Šæ”¾

3. **æ¶æ„çº¦æŸ**ï¼š
   - ViewPool ä¸æ¥æ”¶ entityIdï¼ˆPresentation å±‚ä¸åº”çŸ¥é“ ECSï¼‰
   - ViewPool ä¸æä¾› getAsync()ï¼ˆé¿å…ç ´åå”¯ä¸€å‡ºå£è§„åˆ™ï¼‰
   - ViewPool ä¸ç®¡ç†åŠ è½½çŠ¶æ€ï¼ˆç”± ResourceManager ç®¡ç†ï¼‰
   - `get()` ä¸è¿”å›ä¸´æ—¶ Nodeï¼ˆé¿å…äº‹ä»¶ä¸¢å¤±ã€å¼•ç”¨å¤±æ•ˆï¼‰

4. **é”™è¯¯å¤„ç†**ï¼š
   - åŠ è½½å¤±è´¥ç”± ResourceManager å¤„ç†
   - `get()` æ—¶æ—  Prefab è¿”å› nullï¼Œç”± RenderSyncSystem å¤„ç†
   - ä¸åˆ›å»ºä¸´æ—¶ Node ä½œä¸ºé™çº§æ–¹æ¡ˆ

5. **è°ƒè¯•æ”¯æŒ**ï¼š
   - `ownerKey` å‚æ•°ç”¨äºæ—¥å¿—è®°å½•
   - ä¸æä¾›åŠ è½½çŠ¶æ€æŸ¥è¯¢ï¼ˆç”± ResourceManager æä¾›ï¼‰

## ğŸ¨ğŸ¨ğŸ¨ EXITING CREATIVE PHASE

### è®¾è®¡å†³ç­–æ€»ç»“

**æ¨èæ–¹æ¡ˆ**ï¼šé€‰é¡¹ 4 - çº¯é¢„åŠ è½½ + èŒè´£åˆ†ç¦»

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- âœ… åªæ”¯æŒé¢„åŠ è½½ï¼ˆå¯åŠ¨æ—¶/åœºæ™¯åˆ‡æ¢æ—¶ï¼‰
- âœ… èŒè´£è¾¹ç•Œæ¸…æ™°ï¼ˆViewPool åªè´Ÿè´£æ± åŒ–ï¼ŒResourceManager è´Ÿè´£åŠ è½½ï¼‰
- âœ… ä¸æ¥æ”¶ entityIdï¼ˆPresentation å±‚ä¸åº”çŸ¥é“ ECSï¼‰
- âœ… ä¸è¿”å›ä¸´æ—¶ Nodeï¼ˆé¿å…äº‹ä»¶ä¸¢å¤±ã€å¼•ç”¨å¤±æ•ˆï¼‰
- âœ… ä¸æä¾› getAsync()ï¼ˆé¿å…ç ´åå”¯ä¸€å‡ºå£è§„åˆ™ï¼‰
- âœ… æ˜ç¡®çš„èµ„æºé‡Šæ”¾é¡ºåºï¼ˆå…ˆ ViewPool å ResourceManagerï¼‰

**ä¸‹ä¸€æ­¥**ï¼šå®ç°è¯¥è®¾è®¡ï¼Œæ·»åŠ å•å…ƒæµ‹è¯•
